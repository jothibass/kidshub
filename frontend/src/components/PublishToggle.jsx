import React,{useState}from'react';
export default function PublishToggle({child,onSaved}){const[slug,setSlug]=useState(child.slug||child.name.toLowerCase().replace(/[^a-z0-9]+/g,'-'));const[publishing,setPublishing]=useState(false);
async function save(){setPublishing(true);try{const res=await fetch(`/api/children/${child.id}`,{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({is_published:true,slug})});if(!res.ok)throw new Error('save failed');onSaved&&onSaved(await res.json());}catch(e){alert('Save failed: '+e.message)}finally{setPublishing(false)}}
return(<div className="card"><h4>Publish page</h4><div className="form-row"><input value={slug}onChange={e=>setSlug(e.target.value)}/></div><div className="form-row small">Public URL: <code>http://{window.location.hostname}/p/{slug}</code></div><div style={{display:'flex',justifyContent:'flex-end',gap:8}}><button className="btn"onClick={save}disabled={publishing}>{publishing?'Saving...':'Make Public'}</button></div></div>);}
